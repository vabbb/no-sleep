{% macro flow_track(index, node, hex) %}
{% if node['fromSrc'] == True %}

{% if hex == True %}
<pre class=" text-monospace d-none ns-light-text printableData"><reddump>{{ node['printableData'] }}</reddump></pre>
<pre class=" text-monospace blob"><reddump>{{ node['blob'] }}</reddump></pre>
{% else %}
<pre class=" text-monospace ns-light-text printableData"><reddump>{{ node['printableData'] }}</reddump></pre>
<pre class=" text-monospace d-none blob"><reddump>{{ node['blob'] }}</reddump></pre>
{% endif %}
{% else %}
{% if hex == True %}
<pre class=" text-monospace d-none ns-light-text printableData"><cyandump>{{ node['printableData'] }}</cyandump></pre>
<pre  class=" text-monospace blob"><cyandump>{{ node['blob'] }}</cyandump></pre>
{% else %}
<pre class=" text-monospace ns-light-text printableData"><cyandump>{{ node['printableData'] }}</cyandump></pre>
<pre class=" text-monospace d-none blob"><cyandump>{{ node['blob'] }}</cyandump></pre>
{% endif %}
{% endif %}
{% endmacro %}

<button onclick="pwn('{{ flow_id }}')" type="button" class="btn btn-outline-primary mx-2 mt-2">Pwn</button>
<br /><br />
<h4>{{ flow["srcIP"] }} : <reddump>{{ flow["srcPort"] }}</reddump> => {{ flow["dstIP"] }} : <cyandump>{{ flow["dstPort"] }}</cyandump></h4>
<h5>{% if flow['seenSYN'] %}Seen{% else %}Didn't see{% endif %} flow's SYN packet<br />
  {% if flow['seenFIN'] %}Seen{% else %}Didn't see{% endif %} flow's FIN packet</h5>

{% for node in flow['nodes'] %}
{{ flow_track(loop.index, node, hex) }}
{% endfor %}