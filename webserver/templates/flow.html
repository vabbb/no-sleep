{% macro flow_track(index, f, server, hex) %}
{% if server == f['src'][:f['src'].find(':')] %}
<div class="card bg-info">
  <div class="card-body">
      <table>
          <tr>
            <td><h5 class="card-title">{{ index }}. Server</h5></td>
            <td><h5 class="card-title">{% if f['hasSYN'] %}{{ SYN }}{% endif %} {% if f['hasFIN'] %}{{ FIN }}{% endif %}</h5></td>
          </tr>
        </table>
        {% if hex == True %}
    <p id="data" class="card-text text-monospace d-none">
      {{ f['data'] }}
    </p>
    <p id="hex" class="card-text text-monospace">
      {{ f['hex'] }}
    </p>
    {% else %}
    <p id="data" class="card-text text-monospace">
      {{ f['data'] }}
    </p>
    <p id="hex" class="card-text text-monospace d-none">
      {{ f['hex'] }}
    </p>
    {% endif %}
  </div>
</div>
{% else %}
<div class="card bg-warning">
  <div class="card-body">
    <table>
      <tr>
        <td><h5 class="card-title">{{ index }}. Client</h5></td>
        <td><h5 class="card-title">{% if f['hasSYN'] %}{{ SYN }}{% endif %} {% if f['hasFIN'] %}{{ FIN }}{% endif %}</h5></td>
      </tr>
    </table>
    {% if hex == True %}
    <p id="data" class="card-text text-monospace d-none">
      {{ f['data'] }}
    </p>
    <p id="hex" class="card-text text-monospace">
      {{ f['hex'] }}
    </p>
    {% else %}
    <p id="data" class="card-text text-monospace">
      {{ f['data'] }}
    </p>
    <p id="hex" class="card-text text-monospace d-none">
      {{ f['hex'] }}
    </p>
    {% endif %}
  </div>
</div>
{% endif %}
{% endmacro %}

<button onclick="pwn('{{ flow_id }}')"type="button" class="btn btn-outline-primary mx-2 mt-2">Pwn</button>
{% for f in flow %}
{{ flow_track(loop.index, f, server, hex) }}
{% endfor %}