{% macro flow_track(index, f, server, mhexdata) %}
{% if server == f['src'][:f['src'].find(':')] %}
<div class="card bg-info">
  <div class="card-body">
      <table>
          <tr>
            <td><h5 class="card-title">{{ index }}. Server</h5></td>
            <td><h5 class="card-title">{% if f['hasSYN'] %}{{ SYN }}{% endif %} {% if f['hasFIN'] %}{{ FIN }}{% endif %}</h5></td>
          </tr>
        </table>
    <pre id="data" class="card-text text-monospace mostradata">
      {{ f['data'] }}
    </pre>
    <pre id="hex" class="card-text text-monospace mostrahex">
      {{ mhexdata }}
    </pre>
  </div>
</div>
{% else %}
<div class="card bg-warning">
  <div class="card-body">
    <table>
      <tr>
        <td><h5 class="card-title">{{ index }}. Client</h5></td>
        <td><h5 class="card-title">{% if f['hasSYN'] %}{{ SYN }}{% endif %} {% if f['hasFIN'] %}{{ FIN }}{% endif %}</h5></td>
      </tr>
    </table>
    <pre id="data" class="card-text text-monospace mostradata">
      {{ f['data'] }}
    </pre>
    <pre id="hex" class="card-text text-monospace mostrahex">
      {{ mhexdata }}
    </pre>
  </div>
</div>
{% endif %}
{% endmacro %}

<button onclick="pwn('{{ flow_id }}')"type="button" class="btn btn-outline-primary mx-2 mt-2">Pwn</button>
{% for f,mhexdata in flow %}
{{ flow_track(loop.index, f, server, mhexdata) }}
{% endfor %}
