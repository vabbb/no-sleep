{% macro flow_track(index, node, hex) %}
{% if node['fromSrc'] == True %}

{% if hex == True %}
<pre id="printableData" class=" text-monospace d-none ns-light-text"><reddump>{{ node['printableData'] }}</reddump></pre>
<p id="blob" class=" text-monospace">{{ node['blob'] }}</p>
{% else %}
<pre id="printableData" class=" text-monospace ns-light-text"><reddump>{{ node['printableData'] }}</reddump></pre>
<p id="blob" class=" text-monospace d-none">{{ node['blob'] }}</p>
{% endif %}
{% else %}
{% if hex == True %}
<pre id="printableData" class=" text-monospace d-none ns-light-text"><cyandump>{{ node['printableData'] }}</cyandump></pre>
<p id="blob" class=" text-monospace">{{ node['blob'] }}</p>
{% else %}
<pre id="printableData" class=" text-monospace ns-light-text"><cyandump>{{ node['printableData'] }}</cyandump></pre>
<p id="blob" class=" text-monospace d-none">{{ node['blob'] }}</p>
{% endif %}
{% endif %}
{% endmacro %}

<button onclick="pwn('{{ flow_id }}')" type="button" class="btn btn-outline-primary mx-2 mt-2">Pwn</button>
<br /><br />
<h4>{{ flow["srcIP"] }} : <cyandump>{{ flow["srcPort"] }}</cyandump> => {{ flow["dstIP"] }} : <reddump>{{ flow["dstPort"] }}</reddump></h4>
<h5>{% if flow['seenSYN'] %}Seen{% else %}Didn't see{% endif %} flow's SYN packet<br />
  {% if flow['seenFIN'] %}Seen{% else %}Didn't see{% endif %} flow's FIN packet</h5>

{% for node in flow['nodes'] %}
{{ flow_track(loop.index, node, hex) }}
{% endfor %}